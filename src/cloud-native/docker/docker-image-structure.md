---
date: 2024-03-02
order: 4
---

# docker 镜像结构

![](/assets/image/cloud-native/docker-image-build.jpg)

docker 镜像的构建过程中，以一个基础镜像为起点，每执行一条构建指令，都会在基础镜像上添加一个新层，每个层都是只读的，并且在构建过程中会逐步叠加，最终使用`docker build`命令构建出一个新的镜像。

## 底层

最底层的kernel代表着宿主机的内核，docker 容器共享宿主机的内核，但是运行在隔离的用户空间中。

## 基础层

基础镜像层是构建过程的起点，它是一个轻量级的、不可变的、只读的文件系统，包含了创建容器实例所需的最小运行环境和应用程序。

## 镜像层

在基础镜像层之上，对应Dockerfile中的每一条构建指令，都会在基础镜像层上添加一个新的镜像层，每个镜像层都是只读的，并且在构建过程中会逐步叠加。

## 顶层

最上面一层是可写的容器层。当容器启动时，它在只读镜像层上添加一个可写层，所有对容器的改动都会发生在这个可写层上。

当容器被删除时，这个可写层也会被删除，而下面的只读镜像层则会被保留。